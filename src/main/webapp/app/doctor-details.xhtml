<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/WEB-INF/template.xhtml">

    <f:metadata>
        <f:viewParam name="id" value="#{doctorDetailBean.doctorId}" required="true" converter="jakarta.faces.Integer"/>
        <f:viewAction action="#{doctorDetailBean.loadDoctor}"/>
    </f:metadata>

    <ui:define name="pageTitle">Doctor Details</ui:define>

    <ui:define name="content">
        <h:form id="form">
            <div class="card" rendered="#{not empty doctorDetailBean.doctor}">
                <p:toolbar>
                    <p:toolbarGroup>
                        <p:button value="Back to Staff List" icon="pi pi-arrow-left" outcome="staff" styleClass="ui-button-secondary"/>
                    </p:toolbarGroup>
                </p:toolbar>

                <p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank" style="margin-top:20px;">
                    <h:outputText value="Name:" styleClass="font-bold"/>
                    <h:outputText value="Dr. #{doctorDetailBean.doctor.firstName} #{doctorDetailBean.doctor.lastName}"/>
                    <h:outputText value="Specialty:" styleClass="font-bold"/>
                    <h:outputText value="#{doctorDetailBean.doctor.speciality}"/>
                    <h:outputText value="Phone:" styleClass="font-bold"/>
                    <h:outputText value="#{doctorDetailBean.doctor.phoneNumber}"/>
                    <p:separator/><p:separator/>
                    <h:outputText value="Username:" styleClass="font-bold"/>
                    <h:outputText value="#{doctorDetailBean.doctor.user.username}"/>
                    <h:outputText value="Email:" styleClass="font-bold"/>
                    <h:outputText value="#{doctorDetailBean.doctor.user.email}"/>
                    <h:outputText value="Account Status:" styleClass="font-bold"/>
                    <p:tag value="#{doctorDetailBean.doctor.user.active ? 'ACTIVE' : 'INACTIVE'}" severity="#{doctorDetailBean.doctor.user.active ? 'success' : 'danger'}"/>
                </p:panelGrid>

                <p:panel header="Upcoming Appointments (#{doctorDetailBean.appointments.size()})" style="margin-top:20px;">
                    <p:dataTable var="appt" value="#{doctorDetailBean.appointments}" emptyMessage="No appointments found.">
                        <p:column headerText="Date"><h:outputText value="#{appt.date}"/></p:column>
                        <p:column headerText="Patient">#{appt.patient.firstName} #{appt.patient.lastName}</p:column>
                        <p:column headerText="Status"><p:tag value="#{appt.status}"/></p:column>
                    </p:dataTable>
                </p:panel>
            </div>
        </h:form>
    </ui:define>
</ui:composition>
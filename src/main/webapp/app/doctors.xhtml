<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
    <title>Doctors - MedCare HMS</title>
</h:head>
<h:body>
    <h:form id="form">
        <h2>Doctors</h2>

        <p:dataTable id="dt-doctors" value="#{doctorBean.doctors}" var="d" selectionMode="single"
                     selection="#{doctorBean.selectedDoctor}" rowKey="#{d.doctorId}" paginator="true" rows="5"
                     editable="false" editMode="row">
            <p:column headerText="Name">#{d.firstName} #{d.lastName}</p:column>
            <p:column headerText="Speciality">#{d.speciality}</p:column>
            <p:column headerText="Phone">#{d.phoneNumber}</p:column>

            <p:column headerText="Actions">
                <p:commandButton value="Delete"
                                 action="#{doctorBean.setSelectedDoctor(d)}"
                                 update=":form"
                                 rendered="#{userBean.user.role == 'ADMIN'}"
                                 process="@this"
                                 oncomplete="PF('confirmDialog').show()" />
            </p:column>
        </p:dataTable>

        <!-- Confirm Delete Dialog -->
        <p:confirmDialog widgetVar="confirmDialog" header="Confirm" message="Are you sure you want to delete this doctor?" severity="warn">
            <p:commandButton value="Yes" action="#{doctorBean.deleteDoctor}" update=":form" oncomplete="PF('confirmDialog').hide()" />
            <p:commandButton value="No" onclick="PF('confirmDialog').hide(); return false;" type="button" />
        </p:confirmDialog>

        <h3>Add / Edit Doctor</h3>
        <p:panelGrid columns="2" style="margin-bottom: 20px;">
            <p:outputLabel value="First Name" for="firstName" />
            <p:inputText id="firstName" value="#{doctorBean.selectedDoctor.firstName}" required="true" label="First Name" />

            <p:outputLabel value="Last Name" for="lastName" />
            <p:inputText id="lastName" value="#{doctorBean.selectedDoctor.lastName}" required="true" label="Last Name" />

            <p:outputLabel value="Speciality" for="speciality" />
            <p:inputText id="speciality" value="#{doctorBean.selectedDoctor.speciality}" required="true" label="Speciality" />

            <p:outputLabel value="Phone" for="phone" />
            <p:inputText id="phone" value="#{doctorBean.selectedDoctor.phoneNumber}" required="true" label="Phone Number" />
        </p:panelGrid>

        <p:commandButton value="Save Doctor"
                         action="#{doctorBean.saveDoctor}"
                         update=":form"
                         icon="pi pi-save" />
    </h:form>
</h:body>
</html>
